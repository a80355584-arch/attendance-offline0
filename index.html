<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Attendance Offline</title>
</head>
<body>

<h2>ğŸ“‹ ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±</h2>
<div id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...</div>

<form id="attendanceForm" action="https://script.google.com/macros/s/AKfycbw1KEhuikIeOVTs8rTnMmVRJ3tqbyzPu-BRNCTWq7f1e98s0PMIijE710kvfyNtsiq7/exec" method="POST" target="hidden_iframe">
  <input type="hidden" name="code" id="codeInput">
</form>
<iframe name="hidden_iframe" style="display:none;"></iframe>

<script>
// Ø­ÙØ¸ Offline Ø£ÙˆÙ„Ù‹Ø§
function saveOffline(code) {
  let queue = JSON.parse(localStorage.getItem('attendanceQueue') || '[]');
  queue.push({code: code, time: new Date().toISOString()});
  localStorage.setItem('attendanceQueue', JSON.stringify(queue));
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙˆØ±Ù‹Ø§ Ù„Ù€ Google Sheet
function submitAttendance(code) {
  saveOffline(code);
  document.getElementById('codeInput').value = code;
  document.getElementById('attendanceForm').submit();
  alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±Ùƒ!");
}

// Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† QR
const urlParams = new URLSearchParams(window.location.search);
const code = urlParams.get('code');
if (code) submitAttendance(code);
</script>


</body>
</html>

